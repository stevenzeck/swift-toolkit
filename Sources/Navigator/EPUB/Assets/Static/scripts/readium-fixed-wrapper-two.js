(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e={SINGLE:"single",SPREAD_LEFT:"spread-left",SPREAD_RIGHT:"spread-right",SPREAD_CENTER:"spread-center"},n={AUTO:"auto",PAGE:"page",WIDTH:"width"};function i(t,i){var o=null,r=null,l=null,a=n.AUTO,s=Object.values(e).includes(i)?i:e.SINGLE,c=document.getElementById(t);c.addEventListener("load",(function(){var t=c.contentWindow.document.querySelector("meta[name=viewport]");if(t){for(var e,n=/(\w+) *= *([^\s,]+)/g,i={};e=n.exec(t.content);)i[e[1]]=e[2];var r=Number.parseFloat(i.width),l=Number.parseFloat(i.height);r&&l&&(o={width:r,height:l},d())}}));var u=c.closest(".viewport");function d(){if(o&&r&&l){c.style.width=o.width+"px",c.style.height=o.height+"px";var t,i=r.width/o.width,u=r.height/o.height;t=a===n.WIDTH?i:Math.min(i,u);var d=o.height*t,f=s===e.SINGLE||s===e.SPREAD_CENTER;if(a===n.WIDTH&&d>r.height)c.style.top=l.top+"px",c.style.transform=f?"translateX(-50%)":"none";else{var h=l.top-l.bottom;c.style.top="calc(50% + "+h+"px)",c.style.transform=f?"translate(-50%, -50%)":"translateY(-50%)"}document.querySelector("meta[name=viewport]").content="initial-scale="+t+", minimum-scale="+t}}return{isLoading:!1,link:null,load:function(t,e){if(t.link&&t.url){var n=this;n.link=t.link,n.isLoading=!0,c.addEventListener("load",(function i(){c.removeEventListener("load",i),setTimeout((function(){n.isLoading=!1,c.contentWindow.eval(`readium.link = ${JSON.stringify(t.link)};`),e&&e()}),100)})),c.src=t.url}else e&&e()},reset:function(){this.link&&(this.link=null,o=null,c.src="about:blank")},eval:function(t){if(this.link&&!this.isLoading)return c.contentWindow.eval(t)},setViewport:function(t,e,i){r=t,l=e,Object.values(n).includes(i)&&(a=i),d()},show:function(){u.style.display="block"},hide:function(){u.style.display="none"}}}var o={left:i("page-left",e.SPREAD_LEFT),right:i("page-right",e.SPREAD_RIGHT),center:i("page-center",e.SPREAD_CENTER)};function r(t){for(const e in o)t(o[e])}t.g.spread={load:function(t){function e(){o.left.isLoading||o.right.isLoading||o.center.isLoading||webkit.messageHandlers.spreadLoaded.postMessage({})}r((function(t){t.reset(),t.hide()}));for(const n in t){const i=t[n],r=o[i.page];r&&(r.show(),r.load(i,e))}},eval:function(t,e){if("#"===t||""===t)r((function(t){t.eval(e)}));else{var n=function(t){for(const i in o){var e,n=o[i];if((null===(e=n.link)||void 0===e?void 0:e.href)===t)return n}return null}(t);if(n)return n.eval(e)}},setViewport:function(t,e,n){t.width/=2,o.left.setViewport(t,{top:e.top,right:0,bottom:e.bottom,left:e.left},n),o.right.setViewport(t,{top:e.top,right:e.right,bottom:e.bottom,left:0},n),o.center.setViewport(t,{top:e.top,right:0,bottom:e.bottom,left:0},n)}}})();
//# sourceMappingURL=readium-fixed-wrapper-two.js.map